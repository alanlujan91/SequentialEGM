{"kind":"Notebook","sha256":"bca9b561540ccf4fb82ca2daf7f28227fdb2d65e3c19b6e0efb945ddb92ba0c0","slug":"example-warpedinterpolation","location":"/code/examples/example_WarpedInterpolation.ipynb","dependencies":[],"frontmatter":{"title":"Warped Interpolation","authors":[{"nameParsed":{"literal":"Alan Lujan","given":"Alan","family":"Lujan"},"name":"Alan Lujan","corresponding":false,"email":"alanlujan91@gmail.com","affiliations":["Johns Hopkins University","Econ-ARK"],"github":"alanlujan91","url":"https://quantmacro.org","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"},"code":{"id":"MIT","name":"MIT License","osi":true,"free":true,"url":"https://opensource.org/licenses/MIT"}},"github":"https://github.com/alanlujan91/SequentialEGM","subject":"Economics","venue":{"title":"REMARK","url":"https://github.com/econ-ark/REMARK"},"numbering":{"figure":true,"equation":true,"table":true,"code":true,"heading_1":true,"heading_2":true,"heading_3":true,"heading_4":true,"heading_5":true,"heading_6":true},"keywords":["endogenous grid method","stochastic dynamic programming","machine learning","gaussian process regression"],"affiliations":[{"id":"Johns Hopkins University","name":"Johns Hopkins University"},{"id":"Econ-ARK","name":"Econ-ARK"}],"math":{"\\CARA":"\\alpha","\\CRRA":"\\rho","\\PtyLab":"\\mathrm{Z}","\\ptyLab":"z","\\TaxComb":"\\mathcal{T}","\\Prob":"\\mathbb{P}","\\DiePrb":"\\mathsf{D}","\\diePrb":"\\mathsf{d}","\\LivPrb":"\\cancel{\\DiePrb}","\\livPrb":"\\cancel{\\diePrb}","\\DiscFac":"\\beta","\\DieFac":"\\pDead","\\GroFac":"\\Omega","\\BalGroFac":"\\check","\\permGroFac":"\\Gamma","\\PermGroFac":"\\pmb{\\Phi}","\\PopnGroFac":"\\Xi","\\APFac":"\\text{\\pmb{\\Thorn}}","\\PopFac":"\\PopGro","\\RPFac":"\\APFac_{\\Rfree}","\\DeprFac":"\\daleth","\\LivFac":"\\Alive","\\aVec":"\\vec{\\mathrm{a}}","\\bVec":"\\vec{\\mathrm{\\bNrm}}","\\cVec":"\\vec{\\mathrm{\\cNrm}}","\\mVec":"\\vec{\\mathrm{m}}","\\yVec":"\\vec{\\mathrm{\\yNrm}}","\\Inc":"Y","\\inc":"y","\\PInc":"P","\\AFunc":"\\mathrm{A}","\\aFunc":"\\mathrm{a}","\\BFunc":"\\mathrm{B}","\\bFunc":"\\mathrm{b}","\\CFunc":"\\mathrm{C}","\\cFunc":"\\mathrm{c}","\\MPCFunc":"\\pmb{\\kappa}","\\DFunc":"\\mathrm{D}","\\dFunc":"\\mathrm{d}","\\bEndFunc":"\\mathfrak{b}","\\CEndFunc":"\\mathfrak{C}","\\cEndFunc":"\\mathfrak{c}","\\dEndFunc":"\\mathfrak{d}","\\lEndFunc":"\\mathfrak{l}","\\mEndFunc":"\\mathfrak{m}","\\nEndFunc":"\\mathfrak{n}","\\VEndFunc":"\\mathfrak{V}","\\vEndFunc":"\\mathfrak{v}","\\zEndFunc":"\\mathfrak{z}","\\ProdFunc":"\\mathrm{F}","\\prodFunc":"\\mathrm{f}","\\EFunc":"\\mathrm{E}","\\eFunc":"\\mathrm{e}","\\FFunc":"\\mathrm{F}","\\fFunc":"\\mathrm{f}","\\GFunc":"\\mathrm{G}","\\gFunc":"\\mathrm{g}","\\vBegFunc":"\\pmb{\\upsilon}","\\HFunc":"\\mathrm{H}","\\hFunc":"\\mathrm{h}","\\IFunc":"\\mathrm{I}","\\iFunc":"\\mathrm{i}","\\chiFunc":"\\pmb{\\chi}","\\phiFunc":"\\digamma","\\JFunc":"\\mathrm{J}","\\jFunc":"\\mathrm{j}","\\KFunc":"\\mathrm{K}","\\kFunc":"\\mathrm{k}","\\LFunc":"\\mathrm{L}","\\utilFunc":"\\mathrm{u}","\\MFunc":"\\mathrm{M}","\\mFunc":"\\mathrm{m}","\\NFunc":"\\mathrm{N}","\\nFunc":"\\mathrm{n}","\\OFunc":"\\mathrm{O}","\\PFunc":"\\mathrm{P}","\\pFunc":"\\mathrm{p}","\\QFunc":"\\mathrm{Q}","\\RFunc":"\\mathrm{R}","\\rFunc":"\\mathrm{r}","\\SFunc":"\\mathrm{S}","\\sFunc":"\\mathrm{s}","\\MPSFunc":"\\pmb{lambda}","\\TFunc":"\\mathrm{T}","\\UFunc":"\\mathrm{U}","\\uFunc":"\\mathrm{u}","\\VFunc":"\\mathrm{V}","\\vFunc":"\\mathrm{v}","\\cPDVFunc":"\\mathbb{C}","\\pPDVFunc":"\\mathbb{P}","\\uPDVFunc":"\\mathbb{U}","\\cLevFunc":"\\pmb{\\cFunc}","\\VLevFunc":"\\pmb{\\mathrm{V}}","\\vLevFunc":"\\pmb{\\mathrm{v}}","\\RevFunc":"\\pmb{\\Pi}","\\revFunc":"\\pmb{\\pi}","\\WFunc":"\\mathrm{W}","\\wFunc":"\\mathrm{w}","\\XFunc":"\\mathrm{X}","\\xFunc":"\\mathrm{x}","\\YFunc":"\\mathrm{Y}","\\yFunc":"\\mathrm{y}","\\ZFunc":"\\mathrm{Z}","\\zFunc":"\\mathrm{z}","\\MPC":"\\kappa","\\PIHMPC":"\\varkappa","\\MinMPC":"\\uline{\\kappa}","\\MinMinMPC":"\\underline{\\kappa}","\\MaxMinMPC":"\\hat{\\underline{\\kappa}}","\\MaxMPC":"\\bar{\\kappa}","\\MaxMaxMPC":"\\bar{\\bar{\\kappa}}","\\itc":"\\zeta","\\kPriceAfterITC":"\\mathscr{P}","\\PostITC":"\\cancel{\\zeta}","\\pDead":"\\mathfrak{D}","\\TaxPaid":"T","\\WMid":"\\BLev","\\wMid":"\\bLev","\\Wmid":"\\BRat","\\wmid":"\\bRat","\\Dvdnd":"\\mathbf{D}","\\dvdnd":"d","\\edvdnd":"\\grave{\\dvdnd}","\\hEnd":"\\mathfrak{h}","\\GovSpend":"X","\\govSpend":"x","\\xpend":"\\xi","\\expend":"\\xi","\\TEnd":"T","\\VEnd":"\\mathfrak{V}","\\vEnd":"\\mathfrak{v}","\\WEnd":"\\ALev","\\wEnd":"\\aLev","\\Wend":"\\ARat","\\wend":"\\aRat","\\permGroFacInd":"\\pmb{\\phi}","\\permShkInd":"\\psi","\\tranShkInd":"\\theta","\\permLvlInd":"\\mathrm{p}","\\RCpnd":"\\mathbf{R}","\\Mod":"\\tilde","\\Rprod":"\\mathscr{R}","\\rprod":"\\mathscr{r}","\\RProd":"\\mathsf{R}","\\rProd":"\\mathsf{r}","\\tranShkIndStd":"\\sigma_{\\tranShkInd}","\\tranShkAggStd":"\\sigma_{\\tranShkAgg}","\\ShkMeanOneLogStd":"\\sigma_{\\ShkMeanOneLog}","\\ShkLogZeroLogStd":"\\sigma_{\\cancel{\\ShkMeanOneLog}}","\\PermShkStd":"\\sigma_{\\PermShk}","\\TranShkStd":"\\sigma_{\\TranShk}","\\prud":"\\eta","\\tFwd":"n","\\aE":"\\aRat^{e}","\\BE":"\\BRat^{e}","\\bE":"\\bRat^{e}","\\CE":"\\CRat^{e}","\\cE":"\\cRat^{e}","\\Price":"\\mathsf{P}","\\kPrice":"\\mathsf{P}","\\Severance":"\\kappa","\\MPCE":"\\MPC^{e}","\\Rfree":"\\mathsf{R}","\\rfree":"\\mathsf{r}","\\TaxFree":"\\cancel{\\Tax}","\\Age":"Z","\\age":"z","\\Wage":"\\mathsf{W}","\\wage":"\\mathsf{w}","\\bTargE":"\\check{b}^{e}","\\CTargE":"\\CTarg^{\\null}","\\cTargE":"\\check{c}^{e}","\\kTargE":"\\Target{k}^{e}","\\STargE":"\\Target{\\SRat}^{\\null}","\\sTargE":"\\Target{\\sRat}^{\\null}","\\yTargE":"\\check{y}^{e}","\\ME":"\\MRat^{e}","\\mE":"\\mRat^{e}","\\TermTime":"T","\\ShkMeanOne":"\\Theta","\\PopE":"\\mathcal{E}","\\popE":"e","\\labShare":"\\nu","\\leiShare":"\\zeta","\\kapShare":"\\alpha","\\riskyshare":"\\varsigma","\\Retire":"\\mathbb{R}","\\WPre":"K","\\wPre":"k","\\Leisure":"Z","\\leisure":"z","\\SE":"\\SRat^{e}","\\sE":"\\sRat^{e}","\\BRatE":"{B}^{e}","\\bRatE":"{b}^{e}","\\CRatE":"\\CRat^{e}","\\cRatE":"\\cRat^{e}","\\DiscRate":"\\vartheta","\\pDeadRate":"\\grave{\\cancel{\\mathsf{d}}}","\\erate":"\\cancel{\\mho}","\\pDieRate":"\\grave{\\mathsf{d}}","\\timeRate":"\\vartheta","\\saveRate":"\\grave{s}","\\MRatE":"\\MRat^{e}","\\mRatE":"\\mRat^{e}","\\SRatE":"\\SRat^{e}","\\sRatE":"\\sRat^{e}","\\srate":"\\varsigma","\\urate":"\\mho","\\TaxRate":"t","\\empState":"\\xi","\\discRte":"\\tau","\\DiscRte":"\\vartheta","\\GroRte":"\\omega","\\BalGroRte":"\\tilde","\\permGroRte":"\\gamma","\\PermGroRte":"\\varphi","\\PopnGroRte":"\\xi","\\APRte":"\\text{\\thorn}","\\GPRte":"\\text{\\thorn}_{\\PermGroRte}","\\popRte":"\\popGro","\\RPRte":"\\text{\\thorn}_{\\rfree}","\\deprRte":"\\delta","\\Value":"\\mathrm{V}","\\VE":"{V}^{e}","\\vE":"{v}^{e}","\\Save":"S","\\save":"s","\\RSave":"\\underline{\\Rfree}","\\rsave":"\\underline{\\rfree}","\\Abve":"\\bar","\\BLevE":"\\BLev^{e}","\\bLevE":"\\bLev^{e}","\\CLevE":"\\CLev^{e}","\\cLevE":"\\cLev^{e}","\\mLevE":"\\mLev^{e}","\\SLevE":"\\SLev^{e}","\\sLevE":"\\sLev^{e}","\\Alive":"\\mathcal{L}","\\cFuncAbove":"\\bar{\\mathrm{c}}","\\aRatBF":"\\pmb{a}","\\bRatBF":"\\pmb{\\mathrm{b}}","\\cRatBF":"\\pmb{c}","\\mRatBF":"\\pmb{\\mathrm{m}}","\\ALevBF":"\\mathbf{A}","\\aLevBF":"\\mathbf{a}","\\BLevBF":"\\mathbf{B}","\\bLevBF":"\\mathbf{b}","\\CLevBF":"\\mathbf{C}","\\cLevBF":"\\mathbf{c}","\\HLevBF":"\\mathbf{H}","\\hLevBF":"\\mathbf{h}","\\KLevBF":"\\mathbf{K}","\\kLevBF":"\\mathbf{k}","\\LLevBF":"\\mathbf{L}","\\lLevBF":"\\pmb{\\ell}","\\MLevBF":"\\mathbf{M}","\\mLevBF":"\\mathbf{m}","\\OLevBF":"\\mathbf{O}","\\oLevBF":"\\mathbf{o}","\\PLevBF":"\\mathbf{P}","\\pLevBF":"\\mathbf{p}","\\SLevBF":"\\mathbf{S}","\\sLevBF":"\\mathbf{s}","\\vLevBF":"\\mathbf{v}","\\YLevBF":"\\mathbf{Y}","\\yLevBF":"\\mathbf{y}","\\ZLevBF":"\\mathbf{Z}","\\zLevBF":"\\pmb{z}","\\CDF":"\\mathcal{F}","\\SDF":"\\MLev","\\RfreeEff":"\\bar{\\Rfree}","\\CGroPF":"\\Lambda","\\cGroPF":"\\lambda","\\WGroPF":"\\mathrm{G}","\\MPCPPF":"\\Pi","\\vBeg":"\\upsilon","\\WBeg":"\\KLev","\\wBeg":"\\kLev","\\aAgg":"\\mathsf{A}","\\cAgg":"\\pmb{C}","\\permGroFacAgg":"\\Phi","\\RfreeAgg":"\\Agg{\\Rfree}","\\PermShkAgg":"\\Psi","\\permShkAgg":"\\Psi","\\TranShkAgg":"\\Theta","\\tranShkAgg":"\\Theta","\\permLvlAgg":"\\mathrm{P}","\\PermLvlAgg":"\\PLvl","\\zAgg":"\\pmb{Z}","\\ShkMeanOneLog":"\\theta","\\mBalLog":"\\BalGroRte{m}","\\EpremLog":"\\varphi","\\ShkLogZeroLog":"\\cancel{\\ShkMeanOneLog}","\\pLog":"p","\\ImpG":"\\Im}_{\\PGro","\\impg":"\\imath}_{\\pGro","\\ATarg":"\\check{A}","\\aTarg":"\\check{a}","\\BTarg":"\\check{B}","\\bTarg":"\\check{b}","\\CTarg":"\\Target{C}","\\cTarg":"\\check{c}","\\BTargTarg":"\\Target{\\Target{\\BRat}}","\\bTargTarg":"\\Target{\\Target{\\bRat}}","\\cTargTarg":"\\Target{\\Target{\\cRat}}","\\STargTarg":"\\Target{\\Target{\\SRat}}","\\sTargTarg":"\\Target{\\Target{\\sRat}}","\\kTarg":"\\Target{k}","\\mTarg":"\\check{m}","\\STarg":"\\Target{\\SRat}","\\sTarg":"\\Target{\\sRat}","\\vTarg":"\\Target{\\vRat}","\\yTarg":"\\check{y}","\\CGroOverG":"\\Upsilon","\\avg":"\\bar","\\h":"h","\\Wealth":"O","\\wealth":"o","\\Hi":"\\hat","\\Chi":"\\mathrm{X}","\\NI":"Z","\\TaxUI":"\\tau","\\adj":"\\mathrm{j}","\\PermGroFacAdj":"\\underline{\\PermGroFac}","\\PGroAdj":"\\underline{\\PGro}","\\pGroAdj":"\\underline{\\pGro}","\\PatPGroAdj":"\\text{\\pmb{\\Thorn}}_{\\underline{\\PGro}}","\\patpGroAdj":"\\text{\\thorn}_{\\underline{\\pGro}}","\\PermGroFacuAdj":"\\underline{\\underline{\\PermGroFac}}","\\PGrouAdj":"\\underline{\\underline{\\PGro}}","\\pGrouAdj":"\\underline{\\underline{\\pGro}}","\\DiscAltuAdj":"\\underline{\\underline{\\beth}}","\\TEndBak":"\\mathsf{p}","\\tBak":"\\pmb{n}","\\TEatBak":"\\mathtt{q}","\\ek":"\\lambda","\\Shk":"\\Phi","\\shk":"\\phi","\\PermShk":"\\mathbf{\\Psi}","\\permShk":"\\psi","\\uInvEuPermShk":"\\underline{\\underline{\\PermShk}}","\\TranShk":"\\pmb{\\xi}","\\PShk":"\\Psi","\\pShk":"\\psi","\\pshk":"\\psi","\\TShk":"\\Xi","\\tShk":"\\xi","\\tshk":"\\xi","\\Work":"\\mathbb{W}","\\vk":"\\lambda","\\util":"u","\\TranShkAll":"\\pmb{\\xi}","\\tShkAll":"\\xi","\\WAll":"O","\\wAll":"o","\\Lvl":"\\mathbf","\\ALvl":"\\mathbf{A}","\\aLvl":"\\mathbf{a}","\\BLvl":"\\mathbf{B}","\\bLvl":"\\mathbf{b}","\\CLvl":"\\mathbf{C}","\\cLvl":"\\mathbf{c}","\\DLvl":"\\mathbf{D}","\\dLvl":"\\mathbf{d}","\\ELvl":"\\mathbf{E}","\\eLvl":"\\mathbf{e}","\\FLvl":"\\mathbf{F}","\\fLvl":"\\mathbf{f}","\\GLvl":"\\mathbf{G}","\\HLvl":"\\mathbf{H}","\\hLvl":"\\mathbf{h}","\\ILvl":"\\mathbf{I}","\\iLvl":"\\mathbf{i}","\\JLvl":"\\mathbf{J}","\\jLvl":"\\mathbf{j}","\\KLvl":"\\mathbf{K}","\\kLvl":"\\mathbf{k}","\\LLvl":"\\mathbf{L}","\\ABalLvl":"\\BalGroFac{\\ALvl}","\\MBalLvl":"\\BalGroFac{\\MNrm}","\\mBalLvl":"\\BalGroFac{m}","\\MLvl":"\\mathbf{M}","\\mLvl":"\\mathbf{m}","\\PermLvl":"\\pLvl","\\NLvl":"\\mathbf{N}","\\PopnLvl":"\\pmb{\\mathrm{N}}","\\OLvl":"\\mathbf{O}","\\PLvl":"\\mathbf{P}","\\pLvl":"\\mathbf{p}","\\QLvl":"\\mathbf{Q}","\\RLvl":"\\mathbf{R}","\\rLvl":"\\mathbf{r}","\\SLvl":"\\mathbf{S}","\\sLvl":"\\mathbf{s}","\\TLvl":"\\mathbf{T}","\\ULvl":"\\mathbf{U}","\\VLvl":"\\mathbf{V}","\\vLvl":"\\mathbf{v}","\\WLvl":"\\mathbf{W}","\\XLvl":"\\mathbf{X}","\\YLvl":"\\mathbf{Y}","\\yLvl":"\\mathbf{y}","\\ZLvl":"\\mathbf{Z}","\\zLvl":"\\mathbf{z}","\\Ham":"\\mathcal{H}","\\EPrem":"\\Phi","\\eprem":"\\varphi","\\tHorOfm":"\\pmb{n}","\\debtLim":"\\mathsf{d}","\\tTerm":"T","\\vFirm":"\\mathrm{e}","\\ANrm":"A","\\aNrm":"a","\\BNrm":"B","\\bNrm":"b","\\CNrm":"C","\\cNrm":"c","\\GPFacNrm":"\\APFac_{\\PermGroFacAdj}","\\DNrm":"D","\\dNrm":"d","\\ENrm":"E","\\eNrm":"e","\\FNrm":"F","\\fNrm":"f","\\bTrgNrm":"\\TargetNrm{\\bNrm}","\\mTrgNrm":"\\TargetNrm{m}","\\HNrm":"H","\\hNrm":"h","\\INrm":"I","\\iNrm":"i","\\JNrm":"J","\\jNrm":"j","\\KNrm":"K","\\kNrm":"k","\\MNrm":"M","\\mNrm":"m","\\PNrm":"P","\\pNrm":"p","\\RNrm":"\\mathcal{R}","\\rNrm":"s","\\SNrm":"S","\\sNrm":"s","\\TargetNrm":"\\hat","\\VNrm":"V","\\vNrm":"v","\\xNrm":"x","\\YNrm":"Y","\\yNrm":"y","\\ZNrm":"Z","\\zNrm":"z","\\Rnorm":"\\mathcal{R}","\\rnorm":"\\mathit{r}","\\vNorm":"\\mathrm{w}","\\WHum":"\\HLev","\\wHum":"\\hLev","\\Whum":"\\HRat","\\whum":"\\hRat","\\Num":"N","\\VNum":"V","\\vNum":"v","\\Mean":"\\mathbb{M}","\\tThen":"\\tau","\\valfn":"\\mathrm{v}","\\aMin":"\\underline{\\aRat}","\\bMin":"\\underline{\\bRat}","\\MPCmin":"\\uline{\\kappa}","\\hEndMin":"\\underline{\\mathfrak{h}}","\\aboveMin":"\\blacktriangle","\\hMin":"\\underline{\\h}","\\HMin":"\\underline{H}","\\pShkMin":"\\underline{\\psi}","\\whumMin":"\\underline{\\hRat}","\\MPCminmin":"\\underline{\\kappa}","\\TranShkEmpMin":"\\underline{\\TranShkEmp}","\\tShkEmpMin":"\\underline{\\theta}","\\MPSmin":"\\pZero^{1/\\CRRA} \\RPFac","\\MPCmaxmin":"\\hat{\\underline{\\kappa}}","\\Decision":"\\mathbb{D}","\\SeveranceRatio":"\\varsigma","\\Lo":"\\check","\\ShkLogZero":"\\cancel{\\ShkMeanOne}","\\pZero":"\\wp","\\pNotZero":"(1-\\pZero)","\\LGro":"\\Lambda","\\lGro":"\\lambda","\\PGro":"\\Gamma","\\pGro":"\\gamma","\\GDPGro":"\\gimel","\\EmpGro":"\\Xi","\\empGro":"\\xi","\\PopGro":"\\Xi","\\popGro":"\\xi","\\PatPGro":"\\text{\\pmb{\\Thorn}}_{\\PGro}","\\patpGro":"\\text{\\thorn}_{\\pGro}","\\XperGro":"\\mathsf{X}","\\xperGro":"\\mathsf{x}","\\DivGro":"\\mathrm{G}","\\divGro":"\\mathsf{g}","\\WGro":"\\mathrm{G}","\\wGro":"\\mathsf{g}","\\RnormWGro":"\\mathcal{R}_{\\WGro}","\\rnormwGro":"\\mathit{r}_{\\wGro}","\\PatWGro":"\\text{\\pmb{\\Thorn}}_{\\WGro}","\\patwGro":"\\text{\\thorn}_{\\wGro}","\\PtyGro":"\\Phi","\\ptyGro":"\\phi","\\RBoro":"\\bar{\\Rfree}","\\rboro":"\\bar{\\rfree}","\\Pareto":"\\zeta","\\Kap":"K","\\kap":"k","\\EEndMap":"\\mathsf{E}","\\TMap":"\\mathscr{T}","\\cP":"\\cons^{\\prime}","\\MPCP":"\\pi","\\taxDep":"\\partial","\\FP":"\\mathrm{F}^{\\prime}","\\fP":"\\mathrm{f}^{\\prime}","\\TranShkEmp":"\\pmb{\\theta}","\\TShkEmp":"\\Theta","\\tShkEmp":"\\theta","\\IncUnemp":"\\mu","\\Pop":"L","\\cPP":"\\cons^{\\prime\\prime}","\\FPP":"\\mathrm{F}^{\\prime\\prime}","\\fPP":"\\mathrm{f}^{\\prime\\prime}","\\cPPP":"\\cons^{\\prime\\prime\\prime}","\\uPPP":"\\mathrm{u}^{\\prime\\prime\\prime}","\\uPP":"\\mathrm{u}^{\\prime\\prime}","\\TaxCorp":"\\Large \\tau","\\taxCorp":"\\tau","\\uP":"\\mathrm{u}^{\\prime}","\\q":"\\koppa","\\adjPar":"\\omega","\\tranShkIndVar":"\\sigma^{2}_{\\tranShkInd}","\\tranShkAggVar":"\\sigma^{2}_{\\tranShkAgg}","\\ShkMeanOneLogVar":"\\sigma^{2}_{\\ShkMeanOneLog}","\\ShkLogZeroLogVar":"\\sigma_{\\cancel{\\ShkMeanOneLog}}^{2}","\\PermShkVar":"\\sigma^{2}_{\\PermShk}","\\TranShkVar":"\\sigma^{2}_{\\TranShk}","\\sdr":"\\mRat","\\Estdr":"\\sigma_{\\risky}","\\xFer":"\\chi","\\XFer":"X","\\nIter":"n","\\power":"\\eta","\\labor":"\\ell","\\Labor":"\\mathrm{L}","\\PLabor":"P","\\Plabor":"P","\\tHor":"\\mathsf{n}","\\error":"\\epsilon","\\Depr":"\\daleth","\\depr":"\\delta","\\ImpR":"\\Im}_{\\Rfree","\\impr":"\\imath}_{\\rfree","\\EVarr":"\\sigma_{\\Risky}^{2}","\\Evarr":"\\sigma_{\\risky}^{2}","\\Err":"Z","\\err":"z","\\CGroOverR":"\\Phi","\\corr":"\\varrho","\\curr":"1","\\Curr":"t","\\tCurr":"t","\\PatR":"\\text{\\pmb{\\Thorn}}_{\\Rfree}","\\patr":"\\text{\\thorn}_{\\rfree}","\\PDies":"\\mathsf{D}","\\pDies":"\\mathsf{d}","\\PLives":"\\cancel{\\PDies}","\\pLives":"\\cancel{\\pDies}","\\Stocks":"S","\\stocks":"s","\\TaxNetTrans":"Z","\\taxNetTrans":"z","\\unins":"\\zeta","\\Cons":"C","\\cons":"c","\\MPS":"\\lambda","\\MinMPS":"\\pZero^{1/\\CRRA} \\PatR","\\MaxMPS":"\\PatR","\\CGroPS":"\\chi","\\Hours":"\\mathfrak{H}","\\hours":"\\mathfrak{h}","\\ASS":"A","\\aSS":"a","\\cEss":"{c}^{e}","\\mEss":"\\check{m}^{e}","\\vEss":"\\check{v}^{e}","\\MSS":"\\breve{M}","\\mSS":"\\breve{m}","\\RGross":"\\breve{\\mathsf{R}}","\\rGross":"\\breve{\\mathsf{r}}","\\tSS":"t","\\effUnits":"X","\\Surplus":"Z","\\surplus":"z","\\TEat":"\\TEnd","\\patpGrohat":"\\hat{\\text{\\thorn}}_{\\pGro}","\\aMat":"[\\mathrm{a}]","\\bMat":"[\\mathrm{\\bNrm}]","\\cMat":"[\\mathrm{\\cNrm}]","\\tShkMat":"[\\mathrm{\\tShkEmp}]","\\mMat":"[\\mathrm{m}]","\\xMat":"[\\mathrm{\\xNrm}]","\\yMat":"[\\mathrm{\\yNrm}]","\\Pat":"\\text{\\pmb{\\Thorn}}","\\pat":"\\text{\\thorn}","\\ARat":"A","\\aRat":"a","\\NFARat":"\\NRat","\\BRat":"B","\\bRat":"b","\\CRat":"C","\\cRat":"c","\\ccRat":"\\mathsf{c}","\\dRat":"d","\\WEndRat":"\\ARat","\\wEndRat":"\\aRat","\\HRat":"H","\\hRat":"h","\\IRat":"I","\\iRat":"i","\\KRat":"K","\\kRat":"k","\\LRat":"L","\\lRat":"l","\\WAllRat":"O","\\wAllRat":"o","\\MRat":"M","\\mRat":"m","\\NRat":"N","\\nRat":"n","\\ORat":"O","\\oRat":"o","\\pRat":"p","\\GDPRat":"P","\\gdpRat":"p","\\SRat":"S","\\sRat":"s","\\VRat":"V","\\vRat":"v","\\WRat":"O","\\wRat":"o","\\XRat":"X","\\xRat":"x","\\YRat":"Y","\\yRat":"y","\\ZRat":"Z","\\zRat":"z","\\Debt":"D","\\debt":"d","\\Target":"\\check","\\WNet":"X","\\wNet":"x","\\straight":"\\Pi","\\weight":"\\omega","\\Habit":"H","\\habit":"h","\\WMkt":"\\MLev","\\wMkt":"\\mLev","\\wmkt":"\\mLev","\\Alt":"\\grave","\\DiscFacAlt":"\\beth","\\DiscAlt":"\\beth","\\ValAlt":"\\mathcal{V}","\\vOptAlt":"\\grave{\\tilde{\\mathfrak{v}}}","\\RiskyAlt":"\\pmb{\\mathfrak{R}}","\\riskyAlt":"\\pmb{\\mathfrak{r}}","\\uPmt":"\\mu","\\SeverancePayment":"\\mathcal{S}","\\kapRent":"\\varkappa","\\Discount":"\\beta","\\tinyAmount":"\\epsilon","\\WTot":"\\mathbf{O}","\\wTot":"\\mathbf{o}","\\Wtot":"O","\\wtot":"o","\\vOpt":"\\tilde{\\mathfrak{v}}","\\Rport":"\\mathbb{R}","\\rport":"\\mathbb{r}","\\FDist":"\\mathcal{F}","\\fDist":"\\mathcal{f}","\\Next":"t+1","\\tNext":"t+1","\\BU":"{B}^{u}","\\bU":"{b}^{u}","\\CU":"\\CRat^{u}","\\cU":"\\cRat^{u}","\\MPCU":"\\MPC^{u}","\\MU":"{M}^{u}","\\mU":"{m}^{u}","\\PopU":"\\mathcal{U}","\\SU":"\\SRat^{u}","\\sU":"\\sRat^{u}","\\PatU":"\\text{\\pmb{\\Thorn}}_{\\urate}","\\patu":"\\text{\\thorn}_{\\urate}","\\bRatU":"{b}^{u}","\\CRatU":"\\CRat^{u}","\\cRatU":"\\cRat^{u}","\\SRatU":"\\SRat^{u}","\\sRatU":"\\sRat^{u}","\\VU":"{V}^{u}","\\vU":"{v}^{u}","\\BLevU":"\\BLev^{u}","\\bLevU":"\\bLev^{u}","\\CLevU":"\\CLev^{u}","\\cLevU":"\\cLev^{u}","\\SLevU":"\\SLev^{u}","\\sLevU":"\\sLev^{u}","\\pSav":"\\phi","\\PDV":"\\mathbb{P}","\\CPDV":"\\text{PDV($C$)}","\\PPDV":"\\text{PDV($P$)}","\\ALev":"A","\\aLev":"a","\\NFALev":"\\NLev","\\BLev":"B","\\bLev":"b","\\CLev":"C","\\cLev":"c","\\DLev":"D","\\ELev":"E","\\FLev":"F","\\fLev":"f","\\GLev":"G","\\HLev":"\\pmb{H}","\\hLev":"\\pmb{h}","\\ILev":"I","\\iLev":"i","\\JLev":"J","\\KLev":"K","\\kLev":"k","\\lLev":"\\ell","\\LLev":"L","\\WAllLev":"\\mathbf{O}","\\wAllLev":"\\mathbf{o}","\\MLev":"M","\\mLev":"m","\\NLev":"N","\\nLev":"n","\\oLev":"\\pmb{o}","\\OLev":"O","\\pLev":"\\pmb{p}","\\PLev":"P","\\GDPLev":"\\pmb{P}","\\gdpLev":"\\pmb{p}","\\PopLev":"\\pmb{N}","\\QLev":"Q","\\RLev":"R","\\SLev":"S","\\sLev":"s","\\TLev":"T","\\ULev":"U","\\uLev":"u","\\VLev":"V","\\vLev":"v","\\wLev":"\\pmb{w}","\\WLev":"W","\\XLev":"X","\\xLev":"x","\\TaxLev":"T","\\YLev":"Y","\\yLev":"y","\\PtyLev":"A","\\ptyLev":"a","\\ZLev":"Z","\\zLev":"z","\\Rev":"\\Pi","\\rev":"\\pi","\\tPrev":"t-1","\\Div":"D","\\DiscFacLiv":"\\underline{\\DiscFacRaw}","\\Inv":"I","\\inv":"i","\\TaxCombInv":"\\mathcal{T}^{-1}","\\EPermShkInv":"\\Ex[\\PermShk^{-1}]","\\InvEPermShkInv":"\\underline{\\PermShk}","\\EpShkInv":"\\Ex[\\pShk^{-1}]","\\InvEpShkInv":"\\underline{\\psi}","\\uInvEpShkuInv":"\\underline{\\underline{\\psi}}","\\VInv":"\\Lambda","\\vInv":"\\scriptstyle \\Lambda \\displaystyle","\\cov":"\\textup{cov}","\\DiscFacRaw":"\\beta","\\GPFacRaw":"\\APFac_{\\PermGroFac}","\\Belw":"\\ushort","\\GovNW":"N","\\govNW":"n","\\cFuncBelow":"\\uline{\\mathrm{c}}","\\tNow":"t","\\cFuncMax":"\\bar{\\bar{\\mathrm{c}}}","\\MPCmax":"\\bar{\\kappa}","\\MPSmax":"\\RPFac","\\MPCmaxmax":"\\bar{\\bar{\\kappa}}","\\Tax":"\\tau","\\tax":"\\tau","\\Ex":"\\mathbb{E}","\\prudEx":"\\omega","\\Steady":"\\bar","\\Risky":"\\mathbf{R}","\\risky":"\\mathbf{r}","\\Seniority":"\\mathsf{X}","\\seniority":"\\mathsf{x}"},"abbreviations":{"GP":"Gaussian Process","GPR":"Gaussian Process Regression","EGM":"Endogenous Grid Method","NEGM":"Nested Endogenous Grid Method","G2EGM":"Generalized Endogenous Grid Method","DCEGM":"Discrete Choice Endogenous Grid Method"},"thumbnail":"/SequentialEGM/build/e43da42ee213ec6a82472d62c235e321.png","exports":[{"format":"ipynb","filename":"example_WarpedInterpolation.ipynb","url":"/SequentialEGM/build/example_WarpedInterp-098c11e796fec07bee477d314be86491.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"import matplotlib.pyplot as plt","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PAeMAoiCvd"}],"key":"EpEjKcaiDB"}],"data":{"type":"notebook-content"},"key":"U7RmVE7XKd"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\n\nfigures_path = \"../../content/figures/\"","key":"L8XMf4edTW"},{"type":"output","id":"Mb5gULLw4gobl4XydIBjy","data":[],"key":"R5mHSLDx5m"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:13.821408Z","iopub.status.busy":"2023-07-20T14:17:13.821408Z","iopub.status.idle":"2023-07-20T14:17:14.223654Z","shell.execute_reply":"2023-07-20T14:17:14.223654Z"}},"key":"R3JXN4Kt8i"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Assume we have a set of points indexed by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WJkJgSQiWV"},{"type":"inlineMath","value":"(i,j)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(i,j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">)</span></span></span></span>","key":"PMrGa6o6Dy"},{"type":"text","value":" in 2D space for which we have corresponding functional values in a 3rd dimension, such that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UVNYIS32ip"},{"type":"inlineMath","value":"f(x_{i,j},y_{i,j}) = z_{i,j}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>z</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">f(x_{i,j},y_{i,j}) = z_{i,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"hCJjDQ4ezr"},{"type":"text","value":". In practice, we are interested in cases where the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qozGqqAcbw"},{"type":"inlineMath","value":"z_{ij}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">z_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Z0G0W7O3Yc"},{"type":"text","value":" are difficult to compute and we are unable to compute them at other values of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xFcOCTmMeV"},{"type":"inlineMath","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"HCdDKr87Xv"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hIFziHjLdu"},{"type":"inlineMath","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"rHtxC3BFTp"},{"type":"text","value":" -- which is why we want to interpolate. For the callibration below, we will generate these ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L8pcfxxqNr"},{"type":"inlineMath","value":"z","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span>","key":"qpb2VRMptZ"},{"type":"text","value":"’s arbitrarily using the function","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zq4OLZilTJ"}],"key":"wtYLomtebt"},{"type":"math","value":"f(x,y) = (xy)^{1/4}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mi>y</mi><msup><mo stretchy=\"false\">)</mo><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>4</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">f(x,y) = (xy)^{1/4}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1/4</span></span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"iJ98kTvQnE"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"because the figures look good for our illustrations.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gsKhwhiTuV"}],"key":"AR6wCkVjFv"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"These ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Ur20OdsMQ3"},{"type":"inlineMath","value":"(x_{i,j},y_{i,j})","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x_{i,j},y_{i,j})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"fTIEK8JuGw"},{"type":"text","value":" points however are not evenly spaced, and do not form a rectilinear grid which would make it easy to interpolate the function off the grid. Nevertheless, these points do have a regular structure as we will see.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Xwj2hVmAkv"}],"key":"k11PhD147y"}],"data":{"type":"notebook-content"},"key":"TgHlNWmCaL"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"points = np.array(\n    [[[1, 7], [3, 8], [5, 9]], [[2, 2], [4, 4], [6, 6]], [[7, 1], [8, 3], [9, 5]]]\n).T\nvalues = np.power(points[0] * points[1], 1 / 4)\nplt.scatter(points[0], points[1], c=\"b\")\nplt.grid()","key":"tCL6LF7Alt"},{"type":"output","id":"kpAwzCTAE7y_MmowMLQ3l","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c1af8ca620cb2c2014717419a2935c3a","path":"/SequentialEGM/build/c1af8ca620cb2c2014717419a2935c3a.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"fHNJXQoZax"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:14.226654Z","iopub.status.busy":"2023-07-20T14:17:14.226654Z","iopub.status.idle":"2023-07-20T14:17:14.381428Z","shell.execute_reply":"2023-07-20T14:17:14.380925Z"}},"key":"DAZdfgGO5Z"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the graph below, we can see the true function in 3D space, along with the points for which we actually know the value of the function.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Bw3y45flip"}],"key":"VzxiOeLmFe"}],"data":{"type":"notebook-content"},"key":"gUFts47wyU"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"ax = plt.figure().add_subplot(projection=\"3d\")\nax.scatter(points[0], points[1], values, c=\"r\")\nax.scatter(points[0], points[1], np.zeros_like(values), c=\"b\", alpha=0.5)\nfor i in range(3):\n    ax.plot(points[0, i], points[1, i], zs=0, zdir=\"z\", c=\"r\", alpha=0.5)\n    ax.plot(points[0, :, i], points[1, :, i], zs=0, zdir=\"z\", c=\"g\", alpha=0.5)\n\nfor i in range(9):\n    ax.plot(\n        np.array([points[0].flat[i]] * 2),\n        np.array([points[1].flat[i]] * 2),\n        [0, values.flat[i]],\n        \"--\",\n        c=\"b\",\n        alpha=0.5,\n    )\n\nx = np.linspace(1, 9, 100)\nxmat, ymat = np.meshgrid(x, x, indexing=\"ij\")\nzmat = np.power(xmat * ymat, 1 / 4)\nax.plot_surface(xmat, ymat, zmat, alpha=0.5)\nax.set_zlim(0, np.max(values))\n\nax.view_init(30, -120)\n\nplt.savefig(figures_path + \"WarpedInterpolation.svg\")\nplt.savefig(figures_path + \"WarpedInterpolation.pdf\")","key":"tDGPav2Mw9"},{"type":"output","id":"J4AO6ISr2xUFfk-LJJoMx","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c05b5d223b14ed77a0eb8e432a582f06","path":"/SequentialEGM/build/c05b5d223b14ed77a0eb8e432a582f06.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"bBKV4wRjcl"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:14.384434Z","iopub.status.busy":"2023-07-20T14:17:14.383433Z","iopub.status.idle":"2023-07-20T14:17:15.770670Z","shell.execute_reply":"2023-07-20T14:17:15.770670Z"}},"key":"ZUOCsoLqQK"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The underlying regular structure comes from the points’ position in the matrix, the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vKgwQ8AIjB"},{"type":"inlineMath","value":"(i,j)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(i,j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">)</span></span></span></span>","key":"uDpfc6odWq"},{"type":"text","value":" coordinates. If we join the points along every row and every column, we can see that the resulting grid is regular and piecewise affine (curvilinear).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UvGQTjiQwk"}],"key":"Pzp9jKA2NE"}],"data":{"type":"notebook-content"},"key":"bzYxir9KDY"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"plt.scatter(points[0], points[1], c=\"b\")\nplt.plot(points[0], points[1], \"g\")\nplt.plot(points[0].T, points[1].T, \"r\")\nplt.grid()","key":"dP6GG0XYRq"},{"type":"output","id":"5Ngb275uIpX8FbRfuaBqw","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ff3fdc2a84d10bf86ce9b76a8e8e35d6","path":"/SequentialEGM/build/ff3fdc2a84d10bf86ce9b76a8e8e35d6.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"Q9DJj7jkhR"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:15.775117Z","iopub.status.busy":"2023-07-20T14:17:15.775117Z","iopub.status.idle":"2023-07-20T14:17:15.926709Z","shell.execute_reply":"2023-07-20T14:17:15.926709Z"}},"key":"Y2XB7hxoMV"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As we can see, this curvilinear grid can be easily transformed into a rectilinear grid by using the coordinate values ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s6NHsCAr8Y"},{"type":"inlineMath","value":"(i,j)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(i,j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">)</span></span></span></span>","key":"ZEcTEYgOzE"},{"type":"text","value":" of the underlying matrix that contains the values. For interpolation, this rectilinear grid allows us to use the standard fast interpolation methods available in SciPy.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EryChOQrkE"}],"key":"REPMYrCykq"}],"data":{"type":"notebook-content"},"key":"tLqC0ymSIH"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"coord_points = np.mgrid[0:3, 0:3]\nplt.scatter(coord_points[0], coord_points[1], c=\"b\")\nplt.plot(coord_points[0], coord_points[1], \"g\")\nplt.plot(coord_points[0].T, coord_points[1].T, \"r\")\nplt.grid()","key":"sDIEwQTEAA"},{"type":"output","id":"HU2zFPyN1oqiKX_FTIegs","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0dd8e6fa13ea31584eead4ae0aea5a99","path":"/SequentialEGM/build/0dd8e6fa13ea31584eead4ae0aea5a99.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"jPkqhrbC2h"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:15.929704Z","iopub.status.busy":"2023-07-20T14:17:15.928704Z","iopub.status.idle":"2023-07-20T14:17:16.083114Z","shell.execute_reply":"2023-07-20T14:17:16.083114Z"}},"key":"LkaXFYwHH8"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.subplots(1, 2, figsize=(10, 5))\n\nplt.subplot(1, 2, 1)\nplt.scatter(points[0], points[1], c=\"b\")\nplt.plot(points[0], points[1], \"g\")\nplt.plot(points[0].T, points[1].T, \"r\")\nplt.grid()\n\nplt.subplot(1, 2, 2)\ncoord_points = np.mgrid[0:3, 0:3]\nplt.scatter(coord_points[0], coord_points[1], c=\"b\")\nplt.plot(coord_points[0], coord_points[1], \"g\")\nplt.plot(coord_points[0].T, coord_points[1].T, \"r\")\nplt.grid()\n\nplt.savefig(figures_path + \"Homotopy.svg\")\nplt.savefig(figures_path + \"Homotopy.pdf\")","key":"O40rK8PlgO"},{"type":"output","id":"8iv58lNu1ykS1Jv1llolU","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2bd08dcc8dd984f22675345601064e11","path":"/SequentialEGM/build/2bd08dcc8dd984f22675345601064e11.png"},"text/plain":{"content":"<Figure size 1000x500 with 2 Axes>","content_type":"text/plain"}}}],"key":"EkUHsn5k1P"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:16.086115Z","iopub.status.busy":"2023-07-20T14:17:16.086115Z","iopub.status.idle":"2023-07-20T14:17:16.472112Z","shell.execute_reply":"2023-07-20T14:17:16.471605Z"}},"key":"RHgkHrk4ki"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Below we graph values of the function at their index coordinate points in the matrix.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KwHraEQSm8"}],"key":"f1tirocick"}],"data":{"type":"notebook-content"},"key":"NR3FvBGvkr"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(subplot_kw={\"projection\": \"3d\"})\nax.plot_surface(coord_points[0], coord_points[1], values, alpha=0.5)\nax.view_init(30, -130)\n\nax.scatter(coord_points[0], coord_points[1], values, c=\"r\")","key":"BW5RwuXqtp"},{"type":"output","id":"h-Zjcyiyf_sCRGoxV_rZs","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"<mpl_toolkits.mplot3d.art3d.Path3DCollection at 0x2682a8bc4f0>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"660b1572c5556e21090dceecfe4b8aa4","path":"/SequentialEGM/build/660b1572c5556e21090dceecfe4b8aa4.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"KHziJOW6gk"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:16.475122Z","iopub.status.busy":"2023-07-20T14:17:16.475122Z","iopub.status.idle":"2023-07-20T14:17:16.596479Z","shell.execute_reply":"2023-07-20T14:17:16.596479Z"}},"key":"ZMXEUrwBeT"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The objective is to be able to interpolate the value of the function at any point off the grid, where presumably we are only interested in points internal to the curvilinear space and not outside the boundaries. For example, we can imagine that we want an approximation to the function at the point ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GYbLiGySd5"},{"type":"inlineMath","value":"(x,y) = (3, 5)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mn>3</mn><mo separator=\"true\">,</mo><mn>5</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x,y) = (3, 5)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">5</span><span class=\"mclose\">)</span></span></span></span>","key":"gE1qsVFyRv"},{"type":"text","value":" pictured below. If we could find the correspoinding point in the coordinate grid, interpolation would be straightforward.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zcnzfitPY3"}],"key":"TFMGCVDMbg"}],"data":{"type":"notebook-content"},"key":"vod6StjkqJ"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"plt.scatter(points[0], points[1], c=\"b\")\nplt.plot(points[0], points[1], \"g\")\nplt.plot(points[0].T, points[1].T, \"r\")\nplt.scatter(3, 5, c=\"m\")\nplt.grid()","key":"rZWliNkh03"},{"type":"output","id":"D6cuHFfj4sTGkgqg0AU6O","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"137f15bf20c7f6a9376a2b9e843e409b","path":"/SequentialEGM/build/137f15bf20c7f6a9376a2b9e843e409b.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"S4lzyeN3JF"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:16.599480Z","iopub.status.busy":"2023-07-20T14:17:16.599480Z","iopub.status.idle":"2023-07-20T14:17:16.799195Z","shell.execute_reply":"2023-07-20T14:17:16.799195Z"}},"key":"tUUex0Nbse"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Method 1: Quad Interpolation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ucBFeAu5vZ"}],"identifier":"method-1-quad-interpolation","label":"Method 1: Quad Interpolation","html_id":"method-1-quad-interpolation","implicit":true,"enumerator":"0.1","key":"nnz65j6tTI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"A straightforward and generalizable approach would be to identify the quadrilateral in which the point lies, and then use quad interpolation to find the corresponding z-value.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JtYj5CFAvZ"}],"key":"T6AdMZr7f6"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Quad interpolation consists of finding the affine transformation that maps the quadrilateral to the unit square, and then applying the transformation to the point of interest. Having located the corresponding point in the unit square, we can use standard bilinear interpolation to find the corresponding z-value.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oHH1eV8MpQ"}],"key":"HFt3c8YKLM"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"image","url":"/SequentialEGM/build/e43da42ee213ec6a82472d62c235e321.png","alt":"Quad Interpolation","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bMLOvy5hK2","urlSource":"https://www.particleincell.com/wp-content/uploads/2012/06/mapping-small.png"},{"type":"text","value":"\n","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"eebwYXGfLE"},{"type":"image","url":"/SequentialEGM/build/15f1166dc0a74c38b526f8bfb9374e07.png","alt":"Quad Interpolation","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"eE17llgqWu","urlSource":"https://www.particleincell.com/wp-content/uploads/2012/06/interpolation-300x279.png"}],"key":"XCjRSPSkNP"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"This approach is generalizable to any number of dimensions, and it is desirable for our purposes. However, we have not found a general tool in the Scientific Python environment that would allow us to do this.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"cBd43NXIb6"}],"key":"Wadz0Jmlhz"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"This appears possible in other proprietary software but we have not found an open source tool that would allow us to do this.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"cEUd64vSoa"}],"key":"AB3EpWIeBu"}],"data":{"type":"notebook-content"},"key":"ADFRjtLAxo"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Method 2:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zRAwY2wTDr"}],"identifier":"method-2","label":"Method 2:","html_id":"method-2","implicit":true,"enumerator":"0.2","key":"gSzJrwFd3k"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We can find where the x-coordinate of the point of interest intersects with the index-coordinates of the matrix.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HM9TR5dGQl"}],"key":"mUVMDUZFtf"}],"data":{"type":"notebook-content"},"key":"GnGNmODeTx"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"plt.scatter(points[0], points[1], c=\"b\")\nplt.plot(points[0], points[1], \"g\")\nplt.plot(points[0].T, points[1].T, \"r\")\nplt.scatter(3, 5, c=\"m\")\nplt.scatter([3, 3], [3, 8], s=150, facecolors=\"none\", edgecolors=\"m\")\nplt.axvline(x=3, color=\"c\", linestyle=\"--\")\nplt.grid()","key":"UXn5OLBZ6M"},{"type":"output","id":"9n7wDdmx7vYuLTkdc7ojo","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"be80cc44ed3861a77ade95a8dadbe427","path":"/SequentialEGM/build/be80cc44ed3861a77ade95a8dadbe427.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"cqkQlyWlcP"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:16.802222Z","iopub.status.busy":"2023-07-20T14:17:16.802222Z","iopub.status.idle":"2023-07-20T14:17:16.953983Z","shell.execute_reply":"2023-07-20T14:17:16.953983Z"}},"key":"dQMKUJc45X"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This is similar to assuming that we have 3 linear interpolators formed by connecting the points on the green lines in the x-direction, and for each interpolator we can approximate the corresponding y and z values using the grid data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FsFIzmYoBc"}],"key":"y2jz1vh6nY"}],"data":{"type":"notebook-content"},"key":"KnhTRqSXUt"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"plt.scatter(points[0], coord_points[1], c=\"b\")\nplt.plot(points[0], coord_points[1], \"g\")\nplt.axvline(x=3, color=\"c\", linestyle=\"--\")\nplt.scatter([3, 3], [0, 1], s=150, facecolors=\"none\", edgecolors=\"m\")\nplt.grid()","key":"gHzL8z1uYI"},{"type":"output","id":"JkaZWdWTSVFddlP-dE2Pg","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b9df062c646e072b31d7ebd624188c8b","path":"/SequentialEGM/build/b9df062c646e072b31d7ebd624188c8b.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"YfAaN9VP5R"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:16.956983Z","iopub.status.busy":"2023-07-20T14:17:16.955984Z","iopub.status.idle":"2023-07-20T14:17:17.096693Z","shell.execute_reply":"2023-07-20T14:17:17.096693Z"}},"key":"foDyIzDPPu"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, for each circle in the figure, we have a corresponding pair ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gqbRR7rk0q"},{"type":"inlineMath","value":"(y,z)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(y,z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span></span></span></span>","key":"Xz1tkA6rLU"},{"type":"text","value":", and we can interpolate in the y-direction to find the corresponding z-value for the point’s y-coordinate.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X7io0ayIDL"}],"key":"xdqHfB7eQt"}],"data":{"type":"notebook-content"},"key":"WNf2dtV5zp"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"plt.scatter(points[0], points[1], c=\"b\")\nplt.plot(points[0], points[1], \"g\")\nplt.plot(points[0].T, points[1].T, \"r\")\nplt.scatter(3, 5, c=\"m\")\nplt.scatter([3, 3], [3, 8], s=150, facecolors=\"none\", edgecolors=\"m\")\nplt.axvline(x=3, color=\"c\", linestyle=\"--\")\nplt.hlines(y=[3, 5, 8], xmin=1, xmax=3, color=\"c\", linestyle=\"--\")\nplt.grid()","key":"fMNjPwH9Bw"},{"type":"output","id":"W7CbQLa3GanDyDuNG3NBy","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4162af0a144cae517cb8ae420dbf8fea","path":"/SequentialEGM/build/4162af0a144cae517cb8ae420dbf8fea.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"EJUHZAgpWD"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:17.099694Z","iopub.status.busy":"2023-07-20T14:17:17.099694Z","iopub.status.idle":"2023-07-20T14:17:17.253220Z","shell.execute_reply":"2023-07-20T14:17:17.253220Z"}},"key":"jaz01UHCef"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.subplots(1, 2, figsize=(10, 5))\n\nplt.subplot(1, 2, 1)\nplt.scatter(points[0], points[1], c=\"b\")\nplt.plot(points[0], points[1], \"g\")\nplt.plot(points[0].T, points[1].T, \"r\")\nplt.scatter(3, 5, c=\"m\")\nplt.scatter([3, 3], [3, 8], s=150, facecolors=\"none\", edgecolors=\"m\")\nplt.axvline(x=3, color=\"c\", linestyle=\"--\")\nplt.hlines(y=[3, 5, 8], xmin=1, xmax=3, color=\"c\", linestyle=\"--\")\nplt.grid()\n\nplt.subplot(1, 2, 2)\n\nplt.scatter(points[0], coord_points[1], c=\"b\")\nplt.plot(points[0], coord_points[1], \"g\")\nplt.axvline(x=3, color=\"c\", linestyle=\"--\")\nplt.scatter([3, 3], [0, 1], s=150, facecolors=\"none\", edgecolors=\"m\")\nplt.grid()\n\nplt.savefig(figures_path + \"Mapping.svg\")\nplt.savefig(figures_path + \"Mapping.pdf\")","key":"ieSnSpRqgH"},{"type":"output","id":"SuV9BygzMQQEOL5_mViY5","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"44fb846d024c245665795cecc4a37cab","path":"/SequentialEGM/build/44fb846d024c245665795cecc4a37cab.png"},"text/plain":{"content":"<Figure size 1000x500 with 2 Axes>","content_type":"text/plain"}}}],"key":"MKxcNAWA6w"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:17.255221Z","iopub.status.busy":"2023-07-20T14:17:17.255221Z","iopub.status.idle":"2023-07-20T14:17:17.689110Z","shell.execute_reply":"2023-07-20T14:17:17.688109Z"}},"key":"Ic6ipQgJeh"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can do the same by connecting the points on the red line, and interpolating ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jCGdZhAtXo"},{"type":"inlineMath","value":"(y, z)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(y, z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span></span></span></span>","key":"UGzZBc1A99"},{"type":"text","value":" values for the point’s x-coordinate.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PfEC7A4auJ"}],"key":"xkxe5VeqHD"}],"data":{"type":"notebook-content"},"key":"YoqCMO9bBM"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"plt.scatter(points[0], coord_points[1].T, c=\"b\")\nplt.plot(points[0].T, coord_points[1], \"r\")\nplt.axvline(x=3, color=\"c\", linestyle=\"--\")\nplt.scatter([3, 3], [0, 1], s=150, facecolors=\"none\", edgecolors=\"m\")\nplt.grid()","key":"e42hKnqcJl"},{"type":"output","id":"aKZ_r7RNFKsM03AKocM8i","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"aedf7f6a9396520090b9ab7f719d752f","path":"/SequentialEGM/build/aedf7f6a9396520090b9ab7f719d752f.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"sbUSdZy8ch"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:17.692127Z","iopub.status.busy":"2023-07-20T14:17:17.692127Z","iopub.status.idle":"2023-07-20T14:17:17.844820Z","shell.execute_reply":"2023-07-20T14:17:17.844820Z"}},"key":"YQ4cc3y4vG"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"plt.scatter(points[0], points[1], c=\"b\")\nplt.plot(points[0], points[1], \"g\")\nplt.plot(points[0].T, points[1].T, \"r\")\nplt.scatter(3, 5, c=\"m\")\nplt.scatter([3, 3], [1.8, 8], s=150, facecolors=\"none\", edgecolors=\"m\")\nplt.axvline(x=3, color=\"c\", linestyle=\"--\")\nplt.hlines(y=[1.8, 5, 8], xmin=1, xmax=3, color=\"c\", linestyle=\"--\")\nplt.grid()","key":"PK74QYjoQM"},{"type":"output","id":"63VLEOY266ihDge6xb7zU","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5f6ec5861773dee9fe8106f9e68c7180","path":"/SequentialEGM/build/5f6ec5861773dee9fe8106f9e68c7180.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"jKZlzGMSK9"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:17.848821Z","iopub.status.busy":"2023-07-20T14:17:17.847820Z","iopub.status.idle":"2023-07-20T14:17:18.001337Z","shell.execute_reply":"2023-07-20T14:17:18.001337Z"}},"key":"peCv5ap0Ml"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"However, the two processes might provide different results. The differences in results arises from the values that are weighted in the interpolation. In the first case, interpolation uses the values that correspond to the quadrangle in which the point of interest lies. In the second case, the lowest cirle lies in an adjacent quadrangle, meaning that the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"faQj1I3sEk"},{"type":"inlineMath","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"DHSbcexP8Z"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FTbHa45EcB"},{"type":"inlineMath","value":"z","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span>","key":"s5nia4MJPR"},{"type":"text","value":" values corresponding to that point come from interpolation in the adjacent quadrangle. Because of this, the second result is weighing values that are further away from the point of interest, and the result is less accurate.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s1tm6cKXfR"}],"key":"LiaE4O4g2p"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Additionally, we could start this method in the y-direction, and the results could be different yet.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LvqF7n4nx0"}],"key":"zZzDDcm07p"}],"data":{"type":"notebook-content"},"key":"BvQjgrTq1n"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"plt.scatter(points[0], points[1], c=\"b\")\nplt.plot(points[0], points[1], \"g\")\nplt.plot(points[0].T, points[1].T, \"r\")\nplt.scatter(3, 5, c=\"m\")\nplt.axvline(x=3, color=\"c\", linestyle=\"--\")\nplt.axhline(y=5, color=\"c\", linestyle=\"--\")\nplt.scatter([3, 3, 3], [1.8, 3, 8], s=150, facecolors=\"none\", edgecolors=\"m\")\nplt.scatter([1.4, 3.75, 5, 9], [5, 5, 5, 5], s=150, facecolors=\"none\", edgecolors=\"m\")\nplt.grid()","key":"uz0sTSpc1j"},{"type":"output","id":"2-qf5Nc-4YWE69Y9fd5m_","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5d6f05fe11a1fb8a64422960883bbfaa","path":"/SequentialEGM/build/5d6f05fe11a1fb8a64422960883bbfaa.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"RlFyiGOvti"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:18.004342Z","iopub.status.busy":"2023-07-20T14:17:18.004342Z","iopub.status.idle":"2023-07-20T14:17:18.173374Z","shell.execute_reply":"2023-07-20T14:17:18.173374Z"}},"key":"J5SJT6NZha"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Method 3: Dense Interpolation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HMAdn5Vaqx"}],"identifier":"method-3-dense-interpolation","label":"Method 3: Dense Interpolation","html_id":"method-3-dense-interpolation","implicit":true,"enumerator":"0.3","key":"MuW6mJqUV4"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"A third approach would be to use an interpolation method once (any of the above, or others), for the cross-product of all x and y coordinates, to create a rectilinear grid of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"agkFUSSIHP"},{"type":"inlineMath","value":"(x,y,z)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x,y,z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span></span></span></span>","key":"IILoa0sj49"},{"type":"text","value":" values. Having done this, we can ignore the original curvilinear grid and use the rectilinear grid for interpolation. This method has the advantage of allowing us to interpolate in the original space and not in the warped space.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"glJ4WzS8GP"}],"key":"Ljzw5BtYzW"}],"data":{"type":"notebook-content"},"key":"TzjS2Ty7jD"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"all_coords = np.mgrid[1:10, 1:10]\nplt.plot(points[0], points[1], \"g\")\nplt.plot(points[0].T, points[1].T, \"r\")\nplt.scatter(all_coords[0], all_coords[1], c=\"y\")\nplt.scatter(points[0], points[1], c=\"b\")\nplt.grid()","key":"aE47e5QDhG"},{"type":"output","id":"rC8zdCxXdiCQEpe5b2wUi","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0d55690e8b6043390a0d98d9cba58e78","path":"/SequentialEGM/build/0d55690e8b6043390a0d98d9cba58e78.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"AQuHpZtWyb"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:18.176375Z","iopub.status.busy":"2023-07-20T14:17:18.176375Z","iopub.status.idle":"2023-07-20T14:17:18.345418Z","shell.execute_reply":"2023-07-20T14:17:18.345418Z"}},"key":"DrFYmYBxVQ"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As illustration, we can use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CJgkSAux1o"},{"type":"inlineCode","value":"HARK.interpolation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UosEcbPtaq"},{"type":"text","value":"’s ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"knKL2kNmno"},{"type":"inlineCode","value":"UnstructuredInterp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eQxlXnSLGc"},{"type":"text","value":" which wraps ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s3dccCC1fL"},{"type":"inlineCode","value":"scipy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yN9IAZBS9g"},{"type":"text","value":"’s unstructured interpolators (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s1wY2ujboq"},{"type":"inlineCode","value":"griddata","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OzjjUJheFG"},{"type":"text","value":"). This method is not very fast, which is why we are looking for a faster alternative.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OFItIhcBas"}],"key":"IsJua1b1AS"}],"data":{"type":"notebook-content"},"key":"itKh5OPN2R"},{"type":"block","children":[{"type":"code","lang":"python","executable":true,"value":"from HARK.interpolation import UnstructuredInterp\n\nz_interp = UnstructuredInterp(values, [points[0], points[1]])\nz_vals = z_interp(all_coords[0], all_coords[1])\n\nfig, ax = plt.subplots(subplot_kw={\"projection\": \"3d\"})\nax.plot_surface(all_coords[0], all_coords[1], z_vals)\nax.plot_surface(xmat, ymat, zmat, alpha=0.5)\nax.view_init(30, -130)","key":"rCvb1r3RYt"},{"type":"output","id":"BunpFBLt1LaRgAAjbG8gk","data":[{"name":"stderr","output_type":"stream","text":"C:\\Users\\alujan\\mambaforge\\envs\\egmn-dev\\lib\\site-packages\\numba\\core\\decorators.py:262: NumbaDeprecationWarning: \u001b[1mnumba.generated_jit is deprecated. Please see the documentation at: https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-generated-jit for more information and advice on a suitable replacement.\u001b[0m\n  warnings.warn(msg, NumbaDeprecationWarning)\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d26d537ea480c7f2fbafaef45f21feb6","path":"/SequentialEGM/build/d26d537ea480c7f2fbafaef45f21feb6.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"PFJ5kmysBw"}],"data":{"type":"notebook-code","execution":{"iopub.execute_input":"2023-07-20T14:17:18.348416Z","iopub.status.busy":"2023-07-20T14:17:18.348416Z","iopub.status.idle":"2023-07-20T14:17:20.187695Z","shell.execute_reply":"2023-07-20T14:17:20.187695Z"}},"key":"sQ9RHiYh8A"},{"type":"block","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Why do we need other tools?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MMllYdtGtc"}],"identifier":"why-do-we-need-other-tools","label":"Why do we need other tools?","html_id":"why-do-we-need-other-tools","implicit":true,"enumerator":"1","key":"q6P4MLzi2L"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"scipy","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XEXfW9a78L"},{"type":"text","value":"’s unstructured interpolators (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fCrQqItLpi"},{"type":"inlineCode","value":"griddata","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QuT1Fiy5pe"},{"type":"text","value":") can be used to interpolate with curvilinear or piecewise affine grids, but they do so by discarding the underlying structure of the grid and instead producing a triangulation of the input points. This triangulation is comparatively slow, and discarding the structure also prevents us from using more fine grained information we may know about the function, such as its derivatives.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t08PNLeSNB"}],"key":"thNIRaG87t"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"An additional tool that we found useful is ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ARTycmnrJP"},{"type":"inlineCode","value":"scikit-image","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gvpCTLqxM9"},{"type":"text","value":"’s ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xxrJRMHtFv"},{"type":"inlineCode","value":"PiecewiseAffineTransform","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"j505xh8XC7"},{"type":"text","value":" which can be used to find the affine transformation that maps the curvilinear grid to a rectilinear grid. Again, however, this tool starts by creating a triangulation of the input points regardless of the structure of the grid.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LkxNyH5sMY"}],"key":"CXJBhlpONX"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"In our applications, we already have a structure to the grid that should be useful for interpolation. Namely, the index coordinate ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ysu8d3mgYa"},{"type":"inlineMath","value":"(i,j)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(i,j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">)</span></span></span></span>","key":"cGMPkE965p"},{"type":"text","value":" of the matrix that contains the values describes a grid that is piecewise affine and/or curvilinear. We would like to use this structure to speed up the interpolation process.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ltkbR3etO6"}],"key":"Fsm3HQlkLS"}],"data":{"type":"notebook-content"},"key":"Nx0jr7MadA"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Questions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BIUSVZW1S9"}],"identifier":"questions","label":"Questions","html_id":"questions","implicit":true,"enumerator":"1.1","key":"a6PEP8lGkB"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Which method is the most accurate?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vep3yJGPce"}],"key":"YSTt6qK7eq"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Which method is the fastest?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"xShbmvEoZt"}],"key":"upmoqrcDhc"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Are there other methods that could be used?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mhT0ut8f18"}],"key":"Lu66q5KIrS"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Do these methods generalize to higher dimensions?","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"qUF0E74wju"}],"key":"alhSqPzImM"}],"key":"GENNIoqXrh"}],"data":{"type":"notebook-content"},"key":"Iq0CZv5MAs"}],"key":"H2rzKMPSOT"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"example-gaussianprocessregression","url":"/example-gaussianprocessregression","group":"Code"}}},"domain":"http://localhost:3000"}